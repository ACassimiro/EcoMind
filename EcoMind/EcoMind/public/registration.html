<!DOCTYPE html>
<html lang="en">
    <head>
        <script src="js/client.js"></script>
        <script type="text/javascript" src="/socket.io/socket.io.js"></script> 
        <!--The above library(/socket.io/socket.io.js) will be generated by socket.io module of server -->
        <script type="text/javascript" src="http://code.jquery.com/jquery-1.10.2.min.js"></script> 
        <link href="css/general.css" rel="stylesheet">

        <style type="text/css">
            body {
                background-image:url(http://www.download-free-wallpaper.com/img2/kekehzijyoljskajgges.jpg);
                background-attachment: fixed;
                -webkit-background-size: cover;
            }
        </style>

        <link rel="icon" href="images/favicon_ecomind.ico">
        <title>Ecomind</title>
    </head>
    <body style="background-image:url(http://www.download-free-wallpaper.com/img2/kekehzijyoljskajgges.jpg);">

        <div id="header">
            <p>Registration</p>
        </div>

        <div class="box regform">
            <img src="images/ecomindlogo.png" width="200" height="200" />
            <form id="registration">
                <div>
                    Email *: <input type="email" id="reg_email" /><br/>
         
                    Password *: <input type="password" id="reg_password" /><br/>
         
                    Name *: <input type="text" id="reg_name" /><br/>
         
                    Date of Birth *: <input type="date of birth" id="reg_dob" /><br/>

                    Gender *: <select id="reg_gender">
                      <option value="female">Female</option>
                      <option value="male">Male</option>
                    </select>
                    <br/>
                    Preferences *:
                    <div id="reg_preferences">
                        <input type="checkbox" name="water"/>Water<br/>
                        <input type="checkbox" name="electricity"/>Electricity<br/>
                        <input type="checkbox" name="food waste"/>Food waste<br/>
                        <input type="checkbox" name="trash"/>Trash<br/>
                        <input type="checkbox" name="car usage"/>Car usage<br/>
                    </div>
         
                <input id="submit" type="button" value="Submit" />
                </div>
            </form>
            <button onclick="location.href = 'login_page.html';">Back to Login</button>
        </div>
        
        <div class="overlay-bg"></div>
        <div class="overlay-ecoform">
            <a class="boxclose" id="boxclose" onclick="closeOverlay(this)"></a>
        </div>
 
        <script type="text/javascript">
            var socket = io.connect("/"); 

            socket.on("message",function(message){  
                /*
                    When server sends data to the client it will trigger "message" event on the client side , by 
                    using socket.on("message") , one cna listen for the ,message event and associate a callback to 
                    be executed . The Callback function gets the dat sent from the server 
                */
                message = JSON.parse(message);
                console.log(message); /*converting the data into JS object */
                if (message.data) {
                  
                    showEcoFormPopUp(message.id);
                    
                } else {
                    alert("We were not able to create your account");
                    
                }

                 
            });

            $(function(){
                $('#submit').click(function(){ /*listening to the button click using Jquery listener*/
                    var data = { /*creating a Js ojbect to be sent to the server*/ 
                        action_type: "registration",
                        http_type: "POST",
                        message: {
                            email: $('#reg_email').val(),
                            password: $('#reg_password').val(),
                            name: $('#reg_name').val(),
                            birthdate: $('#reg_dob').val(),
                            gender: $("#reg_gender option:selected").val()
                        }, 
                        user_id: undefined
                                
                    };

                    data['message']['preferences'] = [];
                    $('#reg_preferences input:checked').each( function () {
                        data['message']['preferences'].push($(this).attr('name'));
                    });

                    socket.send(JSON.stringify(data)); 
 
                    $('#email').val('');
                    $('#password').val('');
                    $('#name').val('');
                    $('#dob').val('');
 
                });
            });
 
        </script>
    </body>
</html>